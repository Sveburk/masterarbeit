\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{pifont}  % Für die Kästchen und Häkchen-Symbole
\usepackage{minted}  % Für Python-Code
\usepackage{xcolor}  % Zum Definieren und Verwenden von Farben
\definecolor{LightGray}{gray}{0.9}
\usepackage[hidelinks]{hyperref} % Für die Hyperlinks im Inhaltsverzeichnis
\usepackage[a4paper, left=2.5cm, right=2.5cm, top=2cm, bottom=2cm]{geometry}

\title{\Huge Masterarbeit Tagebuch}
\author{Sven Burkhardt}
\date{}

\begin{document}
\maketitle
\noindent\hrulefill

\newpage % Neue Seite für das Inhaltsverzeichnis
\tableofcontents

%dieses Dokument wird blogartig geführt. Neuste Einträge sind oben einzufügen. 

%___________________________________________________________________________
% Vorlage 
\noindent\hrulefill
\section{Vorlage \small dd.mm.yyyy } % Kurztitel

\subsection*{Kurzbeschreibung}
Hier kurze Zusammenfassung einfügen.

\subsection*{Erledigte Aufgaben}
\subsubsection*{\small Aufgabentitel}
\ding{51} Aufgabenbeschreibung.\\
\textbf{Ergebnis}: Ergebnisbeschreibung.

\subsection*{Nächste Schritte}
\ding{113} Beschrieb der nächsten Aufgabe.

\subsection*{Offene Fragen}
\ding{113} Beschreibung der offenen Frage.

%___________________________________________________________________________
\newpage % Nach dem Inhaltsverzeichnis eine neue Seite


\section{Überblick Hilfscript CHatGPT_Api_TranskribusXML_to_JSONv3.py}
Dieses Skript verarbeitet XML-Dateien aus einer definierten Ordnerstruktur und sendet deren Inhalt an die OpenAI-API zur automatischen Analyse und Extraktion relevanter Metadaten. Das generierte Ergebnis wird als JSON-Datei gespeichert.

Das Skript ist speziell auf historische Dokumente (z. B. aus dem Männerchor Murg Corpus, 1925-1945) zugeschnitten. Es analysiert und strukturiert die Daten, um relevante Informationen wie Autoren, Empfänger, Orte, Ereignisse und Zeitangaben zu extrahieren.

\section{Voraussetzungen & Einrichtung}

\subsection{API Key setzen}
Bevor das Skript ausgeführt wird, muss der OpenAI-API-Schlüssel als Umgebungsvariable gesetzt werden. Dies kann dauerhaft in der ~/.zshrc-Datei erfolgen:

\begin{minted}{bash}
export OPENAI_API_KEY="sk-..."
source ~/.zshrc
\end{minted}

Alternativ kann das Skript mit VS Code gestartet werden, indem es aus dem Terminal mit folgendem Befehl aufgerufen wird:

\begin{minted}{bash}
code .
\end{minted}

\subsection{Python-Bibliotheken installieren}
Folgende Bibliotheken werden benötigt:

\begin{minted}{bash}
pip install openai
\end{minted}

Falls weitere Module fehlen, kann ein allgemeiner Installationsbefehl helfen:

\begin{minted}{bash}
pip install -r requirements.txt
\end{minted}

\section{Funktionsweise}

Das Skript ist in folgende Hauptbestandteile gegliedert:

\subsection{Basis-Einstellungen}
\begin{itemize}
\item Zähler zur Erfassung der verarbeiteten Dateien und Token-Kosten.
\item API-Schlüssel wird aus der Umgebungsvariable geladen.
\item Pfad-Definitionen für Input- und Output-Verzeichnisse.
\end{itemize}

\subsection{Verzeichnisstruktur durchlaufen}
Das Skript iteriert über alle 7-stelligen Ordner im Basisverzeichnis (base_input_directory). In diesen Ordnern sucht es nach Unterordnern mit Namen Akte_xxx_pdf oder Akte_xxx, die wiederum einen page-Ordner enthalten.

Falls kein page-Ordner gefunden wird, wird die Verarbeitung dieser Akte übersprungen.

\subsection{Verarbeitung der XML-Dateien}
Jede XML-Datei im page-Ordner wird eingelesen und analysiert:
\begin{itemize}
\item Seitennummer extrahieren: Die Dateinamen haben das Muster p001.xml, p002.xml usw.
\item XML-Daten einlesen: Nutzung von xml.etree.ElementTree zur Extraktion von TranskribusMetadata und TextEquiv-Daten.
\item Fehlermanagement: Falls eine Datei nicht geparst werden kann oder keinen verwertbaren Text enthält, wird sie übersprungen.
\end{itemize}

\subsection{Strukturierung der Daten in JSON}
Die extrahierten Informationen werden in einem JSON-Format gespeichert. Dazu gehören:
\begin{itemize}
\item Metadaten (Dokument-ID, Seiten-ID, Bild- und XML-URL)
\item Autor und Empfänger mit Name, Rolle und zugehöriger Organisation
\item Erwähnte Personen, Organisationen, Ereignisse und Orte
\item Dokumentart (z. B. Brief, Protokoll, Rechnung)
\item Dokumentformat (z. B. Handschrift, maschinell, mit Unterschrift, Bild)
\end{itemize}

\subsection{API-Anfrage an OpenAI}
Ein Prompt wird erstellt, um die Inhalte durch die OpenAI-API analysieren zu lassen. Dabei wird explizit vorgegeben:
\begin{itemize}
\item Die historische Relevanz der Dokumente (1925-1945).
\item Die Aufgabenstellung (Identifikation von Dokumenttypen, Metadaten und Inhalten).
\item Die genaue Formatierung der JSON-Antwort.
\end{itemize}

\section{Fehlerbehandlung}
Das Skript enthält mehrere Mechanismen zur Fehlerbehandlung:
\begin{itemize}
\item Fehlermeldungen beim XML-Einlesen (try-except beim Parsen)
\item Fehlermeldungen bei API-Anfragen (try-except um den OpenAI-Aufruf)
\item Fehlermeldungen bei JSON-Speicherung (try-except beim Schreiben der Datei)
\item Logging von Problemen (print(f"> ❌ Fehler beim Parsen der API-Antwort: {e}"))
\end{itemize}

Falls Fehler auftreten, werden sie ausgegeben und das Skript setzt die Verarbeitung der nächsten Datei fort, anstatt komplett abzubrechen.

\section{Fazit}
Dieses Skript automatisiert die Verarbeitung von XML-Dokumenten, extrahiert deren Inhalte und strukturiert die Daten in JSON-Format, das von OpenAI-API analysiert wird. Die Ergebnisse werden gespeichert und abschließend statistisch ausgewertet. Durch Fehlerbehandlung und Logging wird sichergestellt, dass auch bei Problemen das Skript robust bleibt.

Falls du Fragen hast oder Anpassungen benötigst, kannst du einfach den relevanten Abschnitt im Code ändern!

%___________________________________________________________________________
\noindent\hrulefill
\section{Tagging der JPGEGs im AppleFinder \small 26.10.24 } % Kurztitel

\subsection*{Kurzbeschreibung}

Überlegung:
JPEGs sollen bereits im Apple Finder mit Tags versehen werden, um eine effiziente, automatisierte Transkription der Chorunterlagen des Männerchors Murg zu ermöglichen. Geplant ist die Kombination von ChatGPT und Transkribus zur Erkennung unterschiedlicher Dokumententypen. Ein Tag-System, bestehend aus \textbf{„Maschinell“} für maschinengeschriebene und \textbf{„Handschrift“} für handschriftliche Dokumente, gewährleistet die gezielte Zuordnung zur jeweils geeigneten OCR-Software \textit{(Maschinenschrift mit ChatGPT, Handschrift mit Transkribus "German Giant")}.

Dokumente, die sowohl maschinell erstellten Text als auch handschriftliche Elemente enthalten, werden entsprechend ihrer Hauptinformationsgehalt getaggt. Zusätzlich erhalten alle Dokumente mit Unterschriften den Tag \textbf{„Unterschrift“}, um eine gezielte Verarbeitung dieser Elemente sicherzustellen.

\subsection{AppleFinder Tags}

\textcolor{yellow}{\Large $\bullet$} \textbf{Handschrift} \\
\textcolor{blue}{\Large $\bullet$} \textbf{Maschinell} \\
\textcolor{gray}{\Large $\bullet$} \textbf{mitUnterschrift} \\
\textcolor{purple}{\Large $\bullet$} \textbf{Bild} \\

\subsection*{Erledigte Aufgaben}
\subsubsection*{\small Handschriften tagging}
\ding{51} taggen \textcolor{yellow}{\Large $\bullet$} \textbf{Handschrift} in AppleFinder. \\
\ding{51} taggen \textcolor{blue}{\Large $\bullet$} \textbf{Maschinell} in AppleFinder. \\
\ding{51} taggen \textcolor{purple}{\Large $\bullet$} \textbf{Bild} \\
\ding{51} taggen \textcolor{gray}{\Large $\bullet$} \textbf{mitUnterschrift} \\
\\
\textbf{Ergebnis}: Handschriften, Maschinell, Bilder und alle handschriftlichen Unterschriften getaggt

\subsection*{Nächste Schritte}
\ding{113} Skripte schreiben, um maschinelle Text zu extrahieren 
\ding{113} Transkribus für Handschriftliches anschmeißen. \\
\ding{113} Nach Gemeinsamkeiten in den Texten suchen, um automatisierte Abfrage für ChatGPT zu erstellen. \\ 
\ding{113} Ggf. Aufteilung in unterschiedliche Korpora (Briefe handschr. Briefe schreibmaschine, Zeitungsunterlagen.)\\
\ding{113} Transkribus für Handschriften verwenden. \\

\subsection*{Offene Fragen}
\ding{113} Sollen die Bilder gelöscht werden?\\
%-------------------------------------------------------


%___________________________________________________________________________

\noindent\hrulefill
\section{JPG Datenbereinigung - leere Seiten löschen \small 25.10.2024 } % Kurztitel

\subsection*{JPG Datenbereinigung}
Alle JPGs ohne Inhalt, also beispielsweise Rückseiten, werden gelöscht. Regel: sobald etwas handschriftlich oder gedruckt auf einer Seite steht, bleibt es erhalten. Im Moment sind auch Bilder (Bsp. Postkarten inbegriffen.Bilder mit Taggs 
\subsection{Anmerkung}
Geschichte/Chronik/Gründung des Männerchors in Akte 323

\subsection*{Erledigte Aufgaben}
\subsubsection*{\small JPG Datenbereinigung }
\ding{51}Alle JPGs ohne Inhalt, also beispielsweise Rückseiten, werden gelöscht.\\
\textbf{Ergebnis}: Reiner JPG Korpus mit Schriftgut, aber auch Bildern (bspw. Postkarten)

\subsection*{Nächste Schritte}
\ding{113} Nach Gemeinsamkeiten in den Texten suchen, um automatisierte Abfrage für ChatGPT zu erstellen. \\ 
\ding{113}Ggf. Aufteilung in unterschiedliche Korpora (Briefe handschr. Briefe schreibmaschine, Zeitungsunterlagen.)\\
\ding{113} Transkribus für Handschriften verwenden.

\subsection*{Offene Fragen}
\ding{113} Sollen die Bilder gelöscht werden?\\
\ding{113} Handschriftliche, maschinengeschriebene und gemischte Daten taggen? Ggf. erst später mit ChatGPT.\\
\ding{113} Transkribus für Handschriften verwenden?

%___________________________________________________________________________

\noindent\hrulefill

\section{Datennormalisierung PDF zu JPEG \small 24.10.2024}
\subsection*{Kurzbeschrieb}
Heute zwei Python-Skripte zur Normalisierung der Akten geschrieben:

\subsection*{Erledigte Augaben}
\subsubsection*{\small PDF zu JPG Konvertierung}
\ding{51} Skript \textbf{\textit{JPEG-to-PDF.py}} geschrieben.  \\
\textbf{Ergebnis} Alle PDF-Seiten in JPGs umgewandelt, Dateinamen mit Seitenzahlen formatiert.

\subsubsection*{\small Prüfung der Aktennummern}
\ding{51} Skript \textbf{\textit{Check-if-all-files-complete.py}} geschrieben. \\
\textbf{Ergebnis}: Überprüft, ob Akten von 001 bis 425 vorhanden sind. Alle Akten sind vollständig in JPG umgewandelt.

\subsection*{Nächste Schritte}
\ding{113} Daten für OCR-Bereinigung vorbereiten, leere Seiten manuell entfernen.
\subsection*{Offene Fragen}
\ding{113} Handschriftliche, maschinengeschriebene und gemischte Daten taggen? Ggf. erst später mit ChatGPT.

\noindent\hrulefill

%___________________________________________________________________________
\end{document}

